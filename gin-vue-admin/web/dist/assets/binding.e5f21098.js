/*! 
 Build based on gin-vue-admin 
 Time : 1682150634000 */
import{r as e,a,aB as l,o as t,c as s,d as i,e as r,w as o,h as u,V as d,aD as n,a1 as p,aF as c,a4 as v,K as m,c1 as f,j as b,d8 as h,aw as y,E as _}from"./index.6e37b4a9.js";import{E as g}from"./dialog.f45d28df.js";import"./overlay.22cd6673.js";import{E as j}from"./divider.4dde4af0.js";import{E as k}from"./pagination.03bff998.js";/* empty css              */import"./tag.399f43c4.js";import{E as w,a as x}from"./select.df075b2f.js";import"./scrollbar.7d3c2ec6.js";/* empty css               */import{E as C,a as V}from"./table-column.555500cb.js";import"./checkbox.22c523d6.js";/* empty css                */import{E as D}from"./popover.b8912991.js";import{E as I,a as U}from"./form-item.4fb89422.js";/* empty css               *//* empty css             */import{E}from"./date-picker.3abfbefd.js";import{g as z,d as A,s as S,a as N,c as B,u as R}from"./binding.b8bea51c.js";import{g as F}from"./server.01438680.js";import{C as K,b as T}from"./clipboard.33f58dfd.js";import{f as q}from"./format.a25068fd.js";import"./refs.22b77024.js";import"./isEqual.9a8132d8.js";import"./_Uint8Array.74027f42.js";import"./index.de987f53.js";import"./index.a80871d6.js";import"./strings.1b99874f.js";import"./_initCloneObject.ad389fd2.js";import"./dropdown.b561fa59.js";import"./arrays.378bf91a.js";import"./index.3f69170d.js";import"./date.23f5a973.js";import"./dictionary.3a8ea216.js";import"./sysDictionary.95339a94.js";const L={class:"gva-search-box"},O={class:"gva-table-box"},X={class:"gva-btn-list"},G=i("p",null,"确定要删除吗？",-1),H={style:{"text-align":"right","margin-top":"8px"}},J={class:"gva-pagination"},M=i("h2",null,"shadowrocket,qv2ray,v2rayXS",-1),P=["src"],Q=i("h2",null,"v2rayN,v2rayNG,v2rayXS",-1),W=["src"],Y={class:"dialog-footer"},Z={name:"Binding"},$=Object.assign(Z,{setup(Z){new K(".btn");const $=e({server_id:"",user_id:"",alter_id:64}),ee=a({}),ae=e(),le=e(1),te=e(0),se=e(10),ie=e([]),re=e({}),oe=e({share1:"",share1_link:"",share2:"",share2_link:""}),ue=()=>{re.value={},ce()},de=()=>{le.value=1,se.value=10,ce()},ne=e=>{se.value=e,ce()},pe=e=>{le.value=e,ce()},ce=async()=>{const e=await z({page:le.value,pageSize:se.value,...re.value});0===e.code&&(ie.value=e.data.list,te.value=e.data.total,le.value=e.data.page,se.value=e.data.pageSize)};ce();(async()=>{})();const ve=e([]),me=e=>{ve.value=e},fe=e(!1),be=async()=>{const e=[];if(0===ve.value.length)return void b({type:"warning",message:"请选择要删除的数据"});ve.value&&ve.value.map((a=>{e.push(a.ID)}));0===(await A({ids:e})).code&&(b({type:"success",message:"删除成功"}),ie.value.length===e.length&&le.value>1&&le.value--,fe.value=!1,ce())},he=e(""),ye=e(!1),_e=()=>{ye.value=!1},ge=async e=>{0===(await N({ID:e.ID})).code&&(b({type:"success",message:"删除成功"}),1===ie.value.length&&le.value>1&&le.value--,ce())},je=e(!1),ke=()=>{he.value="create",je.value=!0},we=()=>{je.value=!1,$.value={server_id:"",user_id:""}},xe=async()=>{var e;null==(e=ae.value)||e.validate((async e=>{if(!e)return;let a;switch(he.value){case"create":default:a=await B($.value);break;case"update":a=await R($.value)}0===a.code&&(b({type:"success",message:"创建/更改成功"}),we(),ce())}))},Ce=e([]),Ve=async()=>{const e=await F();0===e.code&&(Ce.value=e.data.srvs)},De=e([]),Ie=async()=>{const e=await h();0===e.code&&(De.value=e.data.users)};return Ve(),Ie(),(e,a)=>{const b=E,h=I,z=w,A=x,N=l("refresh"),B=y,R=_,F=U,K=D,Z=C,ce=V,he=k,Ue=j,Ee=g;return t(),s("div",null,[i("div",L,[r(F,{inline:!0,model:re.value,class:"demo-form-inline",onKeyup:c(de,["enter"])},{default:o((()=>[r(h,{label:"创建时间"},{default:o((()=>[r(b,{modelValue:re.value.startCreatedAt,"onUpdate:modelValue":a[0]||(a[0]=e=>re.value.startCreatedAt=e),type:"datetime",placeholder:"开始时间"},null,8,["modelValue"]),u(" — "),r(b,{modelValue:re.value.endCreatedAt,"onUpdate:modelValue":a[1]||(a[1]=e=>re.value.endCreatedAt=e),type:"datetime",placeholder:"结束时间"},null,8,["modelValue"])])),_:1}),r(h,{label:"服务器ip"},{default:o((()=>[r(A,{modelValue:re.value.server_id,"onUpdate:modelValue":a[2]||(a[2]=e=>re.value.server_id=e),clearable:"",filterable:"",style:{width:"194px"}},{default:o((()=>[(t(!0),s(d,null,n(Ce.value,(e=>(t(),p(z,{key:e.ID,value:e.ID,label:e.ip},null,8,["value","label"])))),128))])),_:1},8,["modelValue"]),r(B,{class:"auto-icon",onClick:Ve},{default:o((()=>[r(N)])),_:1})])),_:1}),r(h,{label:"用户名"},{default:o((()=>[r(A,{modelValue:re.value.user_id,"onUpdate:modelValue":a[3]||(a[3]=e=>re.value.user_id=e),clearable:"",filterable:"",style:{width:"194px"}},{default:o((()=>[(t(!0),s(d,null,n(De.value,(e=>(t(),p(z,{key:e.ID,value:e.ID,label:e.nickName},null,8,["value","label"])))),128))])),_:1},8,["modelValue"]),r(B,{class:"auto-icon",onClick:Ie},{default:o((()=>[r(N)])),_:1})])),_:1}),r(h,null,{default:o((()=>[r(R,{type:"primary",icon:"search",onClick:de},{default:o((()=>[u("查询")])),_:1}),r(R,{icon:"refresh",onClick:ue},{default:o((()=>[u("重置")])),_:1})])),_:1})])),_:1},8,["model","onKeyup"])]),i("div",O,[i("div",X,[r(R,{type:"primary",icon:"plus",onClick:ke},{default:o((()=>[u("新增")])),_:1}),r(K,{visible:fe.value,"onUpdate:visible":a[6]||(a[6]=e=>fe.value=e),placement:"top",width:"160"},{reference:o((()=>[r(R,{icon:"delete",style:{"margin-left":"10px"},disabled:!ve.value.length,onClick:a[5]||(a[5]=e=>fe.value=!0)},{default:o((()=>[u("删除")])),_:1},8,["disabled"])])),default:o((()=>[G,i("div",H,[r(R,{type:"primary",link:"",onClick:a[4]||(a[4]=e=>fe.value=!1)},{default:o((()=>[u("取消")])),_:1}),r(R,{type:"primary",onClick:be},{default:o((()=>[u("确定")])),_:1})])])),_:1},8,["visible"])]),r(ce,{ref:"multipleTable",style:{width:"100%"},"tooltip-effect":"dark",data:ie.value,"row-key":"ID",onSelectionChange:me},{default:o((()=>[r(Z,{type:"selection",width:"55"}),r(Z,{align:"left",label:"用户名",width:"120"},{default:o((e=>[u(v(e.row.user.nickName),1)])),_:1}),r(Z,{align:"left",label:"服务器ip",width:"140"},{default:o((e=>[u(v(e.row.server.ip),1)])),_:1}),r(Z,{align:"left",label:"日期",width:"180"},{default:o((e=>[u(v(m(q)(e.row.CreatedAt)),1)])),_:1}),r(Z,{align:"left",label:"按钮组"},{default:o((e=>[r(R,{type:"primary",link:"",icon:"share",class:"table-button",onClick:a=>(async e=>{const a=await S({ID:e.ID});0===a.code&&(console.log("aaa:",a.data.share1),oe.value.share1_link=a.data.share1,oe.value.share2_link=a.data.share2,T.toDataURL(a.data.share1).then((e=>{oe.value.share1=e})),T.toDataURL(a.data.share2).then((e=>{oe.value.share2=e})),ye.value=!0)})(e.row)},{default:o((()=>[u("分享")])),_:2},1032,["onClick"]),r(R,{type:"primary",link:"",icon:"delete",onClick:a=>{return l=e.row,void f.confirm("确定要删除吗?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((()=>{ge(l)}));var l}},{default:o((()=>[u("删除")])),_:2},1032,["onClick"])])),_:1})])),_:1},8,["data"]),i("div",J,[r(he,{layout:"total, sizes, prev, pager, next, jumper","current-page":le.value,"page-size":se.value,"page-sizes":[10,30,50,100],total:te.value,onCurrentChange:pe,onSizeChange:ne},null,8,["current-page","page-size","total"])])]),r(Ee,{modelValue:ye.value,"onUpdate:modelValue":a[7]||(a[7]=e=>ye.value=e),"before-close":_e,title:"弹窗操作"},{default:o((()=>[r(F,{model:oe.value,"label-position":"right",ref_key:"elFormRef",ref:ae,rules:ee,"label-width":"80px"},{default:o((()=>[M,i("div",null,[i("img",{src:oe.value.share1,alt:"二维码",style:{width:"300px",height:"300px"}},null,8,P)]),r(R,{class:"btn","data-clipboard-text":oe.value.share1_link},{default:o((()=>[u("复制")])),_:1},8,["data-clipboard-text"]),r(Ue),Q,i("div",null,[i("img",{src:oe.value.share2,alt:"二维码",style:{width:"300px",height:"300px"}},null,8,W)]),r(R,{class:"btn","data-clipboard-text":oe.value.share2_link},{default:o((()=>[u("复制")])),_:1},8,["data-clipboard-text"])])),_:1},8,["model","rules"])])),_:1},8,["modelValue"]),r(Ee,{modelValue:je.value,"onUpdate:modelValue":a[10]||(a[10]=e=>je.value=e),"before-close":we,title:"弹窗操作"},{footer:o((()=>[i("div",Y,[r(R,{onClick:we},{default:o((()=>[u("取 消")])),_:1}),r(R,{type:"primary",onClick:xe},{default:o((()=>[u("确 定")])),_:1})])])),default:o((()=>[r(F,{model:$.value,"label-position":"right",ref_key:"elFormRef",ref:ae,rules:ee,"label-width":"80px"},{default:o((()=>[r(h,{label:"服务器ip:"},{default:o((()=>[r(A,{modelValue:$.value.server_id,"onUpdate:modelValue":a[8]||(a[8]=e=>$.value.server_id=e),clearable:"",filterable:"",style:{width:"194px"}},{default:o((()=>[(t(!0),s(d,null,n(Ce.value,(e=>(t(),p(z,{key:e.ID,value:e.ID,label:e.ip},null,8,["value","label"])))),128))])),_:1},8,["modelValue"])])),_:1}),r(h,{label:"用户名:"},{default:o((()=>[r(A,{modelValue:$.value.user_id,"onUpdate:modelValue":a[9]||(a[9]=e=>$.value.user_id=e),clearable:"",filterable:"",style:{width:"194px"}},{default:o((()=>[(t(!0),s(d,null,n(De.value,(e=>(t(),p(z,{key:e.ID,value:e.ID,label:e.nickName},null,8,["value","label"])))),128))])),_:1},8,["modelValue"])])),_:1})])),_:1},8,["model","rules"])])),_:1},8,["modelValue"])])}}});export{$ as default};
