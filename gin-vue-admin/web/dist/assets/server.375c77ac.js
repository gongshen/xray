/*! 
 Build based on gin-vue-admin 
 Time : 1682153148000 */
import{r as e,a,o as l,c as t,d as o,e as r,w as i,h as u,aF as d,a4 as s,K as n,c1 as p,j as m,b as c,E as f}from"./index.478f69c8.js";import{E as v}from"./dialog.14f5147e.js";import"./overlay.6224a56d.js";import{E as b}from"./pagination.59255531.js";/* empty css              */import"./tag.1631cc59.js";import"./select.fda82e69.js";import"./scrollbar.f3b871cb.js";/* empty css               */import{E as g,a as y}from"./table-column.00239d86.js";import"./checkbox.b4fadd3f.js";/* empty css                */import{E as _}from"./popover.b242bf83.js";import{E as h,a as j}from"./form-item.d7718ef0.js";/* empty css               */import{E as k}from"./date-picker.dadbc2d4.js";import{a as w,d as V,b as C,r as x,c as U,u as q}from"./server.9d810eb3.js";import{f as D}from"./format.ae7f7ec8.js";import"./refs.ecd25701.js";import"./isEqual.6e065d44.js";import"./_Uint8Array.c02ad389.js";import"./index.180d1878.js";import"./index.8616cb26.js";import"./strings.1b82e4b7.js";import"./_initCloneObject.bd6ed324.js";import"./dropdown.9cfaeb35.js";import"./arrays.378bf91a.js";import"./index.033a2998.js";import"./date.23f5a973.js";import"./dictionary.e5942c3d.js";import"./sysDictionary.47c33a0c.js";const E={class:"gva-search-box"},z={class:"gva-table-box"},F={class:"gva-btn-list"},I=o("p",null,"确定要删除吗？",-1),A={style:{"text-align":"right","margin-top":"8px"}},S={class:"gva-pagination"},B={class:"dialog-footer"},T={name:"Server"},K=Object.assign(T,{setup(T){const K=e({ip:"",port:80,remark:"",total_quota:1e3}),M=a({ip:[{required:!0,message:"请输入服务器IP",trigger:"blur"}],port:[{required:!0,message:"请输入端口号",trigger:"blur"}],reset_date:[{required:!0,message:"请输入流量重置时间",trigger:"blur"}]}),O=e(),G=e(1),R=e(0),J=e(10),N=e([]),P=e({}),H=e({content:""}),L=()=>{P.value={},Y()},Q=()=>{G.value=1,J.value=10,Y()},W=e=>{J.value=e,Y()},X=e=>{G.value=e,Y()},Y=async()=>{const e=await w({page:G.value,pageSize:J.value,...P.value});0===e.code&&(N.value=e.data.list,R.value=e.data.total,G.value=e.data.page,J.value=e.data.pageSize)};Y();(async()=>{})();const Z=e([]),$=e=>{Z.value=e},ee=e(!1),ae=async()=>{const e=[];if(0===Z.value.length)return void m({type:"warning",message:"请选择要删除的数据"});Z.value&&Z.value.map((a=>{e.push(a.ID)}));0===(await V({ids:e})).code&&(m({type:"success",message:"删除成功"}),N.value.length===e.length&&G.value>1&&G.value--,ee.value=!1,Y())},le=e(""),te=e(!1),oe=()=>{te.value=!1},re=async e=>{0===(await C({ID:e.ID})).code&&(m({type:"success",message:"删除成功"}),1===N.value.length&&G.value>1&&G.value--,Y())},ie=async e=>{0===(await x({ID:e.ID,port:e.port,ip:e.ip})).code&&m({type:"success",message:"重启成功"})},ue=e(!1),de=()=>{le.value="create",ue.value=!0},se=()=>{ue.value=!1,K.value={ip:"",port:0,remark:""}},ne=async()=>{var e;null==(e=O.value)||e.validate((async e=>{if(!e)return;let a;switch(le.value){case"create":default:a=await U(K.value);break;case"update":a=await q(K.value)}0===a.code&&(m({type:"success",message:"创建/更改成功"}),se(),Y())}))},pe=e=>e>=1073741824?(e/1073741824).toFixed(1)+" G":e>=1048576?(e/1048576).toFixed(1)+" M":e>=1024?(e/1024).toFixed(1)+" K":e.toFixed(1);return(e,a)=>{const m=k,w=h,V=c,C=f,x=j,U=_,q=g,T=y,Y=b,le=v;return l(),t("div",null,[o("div",E,[r(x,{inline:!0,model:P.value,class:"demo-form-inline",onKeyup:d(Q,["enter"])},{default:i((()=>[r(w,{label:"创建时间"},{default:i((()=>[r(m,{modelValue:P.value.startCreatedAt,"onUpdate:modelValue":a[0]||(a[0]=e=>P.value.startCreatedAt=e),type:"datetime",placeholder:"开始时间"},null,8,["modelValue"]),r(m,{modelValue:P.value.endCreatedAt,"onUpdate:modelValue":a[1]||(a[1]=e=>P.value.endCreatedAt=e),type:"datetime",placeholder:"结束时间"},null,8,["modelValue"])])),_:1}),r(w,{label:"服务器ip"},{default:i((()=>[r(V,{modelValue:P.value.ip,"onUpdate:modelValue":a[2]||(a[2]=e=>P.value.ip=e),placeholder:"搜索条件"},null,8,["modelValue"])])),_:1}),r(w,null,{default:i((()=>[r(C,{type:"primary",icon:"search",onClick:Q},{default:i((()=>[u("查询")])),_:1}),r(C,{icon:"refresh",onClick:L},{default:i((()=>[u("重置")])),_:1})])),_:1})])),_:1},8,["model","onKeyup"])]),o("div",z,[o("div",F,[r(C,{type:"primary",icon:"plus",onClick:de},{default:i((()=>[u("新增")])),_:1}),r(U,{visible:ee.value,"onUpdate:visible":a[5]||(a[5]=e=>ee.value=e),placement:"top",width:"160"},{reference:i((()=>[r(C,{icon:"delete",style:{"margin-left":"10px"},disabled:!Z.value.length,onClick:a[4]||(a[4]=e=>ee.value=!0)},{default:i((()=>[u("删除")])),_:1},8,["disabled"])])),default:i((()=>[I,o("div",A,[r(C,{type:"primary",link:"",onClick:a[3]||(a[3]=e=>ee.value=!1)},{default:i((()=>[u("取消")])),_:1}),r(C,{type:"primary",onClick:ae},{default:i((()=>[u("确定")])),_:1})])])),_:1},8,["visible"])]),r(T,{ref:"multipleTable",style:{width:"100%"},"tooltip-effect":"dark",data:N.value,"row-key":"ID",onSelectionChange:$},{default:i((()=>[r(q,{type:"selection",width:"55"}),r(q,{align:"left",label:"服务器ip",prop:"ip",width:"150"}),r(q,{align:"left",label:"端口",prop:"port",width:"60"}),r(q,{align:"left",label:"使用额度",width:"100"},{default:i((e=>[u(s(pe(e.row.used_quota)),1)])),_:1}),r(q,{align:"left",label:"总额度",width:"100"},{default:i((e=>[u(s(pe(e.row.total_quota)),1)])),_:1}),r(q,{align:"left",label:"备注",prop:"remark",width:"120"}),r(q,{align:"left",label:"重置日期",prop:"reset_date",width:"100"}),r(q,{align:"left",label:"创建日期",width:"180"},{default:i((e=>[u(s(n(D)(e.row.CreatedAt)),1)])),_:1}),r(q,{align:"left",label:"按钮组"},{default:i((e=>[r(C,{type:"primary",link:"",icon:"document",class:"table-button",onClick:a=>(async e=>{H.value.content=JSON.stringify(e.config,null,2),te.value=!0})(e.row)},{default:i((()=>[u("查看配置")])),_:2},1032,["onClick"]),r(C,{type:"primary",link:"",icon:"refresh",onClick:a=>{return l=e.row,void p.confirm("确定要重启代理吗?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((()=>{ie(l)}));var l}},{default:i((()=>[u("代理重启")])),_:2},1032,["onClick"]),r(C,{type:"primary",link:"",icon:"delete",onClick:a=>{return l=e.row,void p.confirm("确定要删除吗?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((()=>{re(l)}));var l}},{default:i((()=>[u("删除")])),_:2},1032,["onClick"])])),_:1})])),_:1},8,["data"]),o("div",S,[r(Y,{layout:"total, sizes, prev, pager, next, jumper","current-page":G.value,"page-size":J.value,"page-sizes":[10,30,50,100],total:R.value,onCurrentChange:X,onSizeChange:W},null,8,["current-page","page-size","total"])])]),r(le,{modelValue:te.value,"onUpdate:modelValue":a[6]||(a[6]=e=>te.value=e),"before-close":oe,title:"配置信息"},{default:i((()=>[r(x,{model:H.value,"label-position":"right",ref_key:"elFormRef",ref:O,rules:M,"label-width":"80px"},{default:i((()=>[o("pre",null,s(H.value.content),1)])),_:1},8,["model","rules"])])),_:1},8,["modelValue"]),r(le,{modelValue:ue.value,"onUpdate:modelValue":a[12]||(a[12]=e=>ue.value=e),"before-close":se,title:"弹窗操作"},{footer:i((()=>[o("div",B,[r(C,{onClick:se},{default:i((()=>[u("取 消")])),_:1}),r(C,{type:"primary",onClick:ne},{default:i((()=>[u("确 定")])),_:1})])])),default:i((()=>[r(x,{model:K.value,"label-position":"right",ref_key:"elFormRef",ref:O,rules:M,"label-width":"80px"},{default:i((()=>[r(w,{label:"服务器ip:",prop:"ip"},{default:i((()=>[r(V,{modelValue:K.value.ip,"onUpdate:modelValue":a[7]||(a[7]=e=>K.value.ip=e),clearable:!0,placeholder:"请输入"},null,8,["modelValue"])])),_:1}),r(w,{label:"端口:",prop:"port"},{default:i((()=>[r(V,{modelValue:K.value.port,"onUpdate:modelValue":a[8]||(a[8]=e=>K.value.port=e),modelModifiers:{number:!0},clearable:!0,placeholder:"请输入"},null,8,["modelValue"])])),_:1}),r(w,{label:"备注:",prop:"remark"},{default:i((()=>[r(V,{modelValue:K.value.remark,"onUpdate:modelValue":a[9]||(a[9]=e=>K.value.remark=e),clearable:!1,placeholder:"请输入"},null,8,["modelValue"])])),_:1}),r(w,{label:"重置日期:",prop:"resetDate"},{default:i((()=>[r(V,{modelValue:K.value.reset_date,"onUpdate:modelValue":a[10]||(a[10]=e=>K.value.reset_date=e),modelModifiers:{number:!0},clearable:!1,placeholder:"请输入"},null,8,["modelValue"])])),_:1}),r(w,{label:"总额度(GB):",prop:"resetDate"},{default:i((()=>[r(V,{modelValue:K.value.total_quota,"onUpdate:modelValue":a[11]||(a[11]=e=>K.value.total_quota=e),modelModifiers:{number:!0},clearable:!1,placeholder:"请输入"},null,8,["modelValue"])])),_:1})])),_:1},8,["model","rules"])])),_:1},8,["modelValue"])])}}});export{K as default};
