/*! 
 Build based on gin-vue-admin 
 Time : 1680873134000 */
import{r as a,af as e,o as t,c as l,d as o,e as i,w as s,h as n,a3 as r,J as p,bm as c,j as d,b as m,E as u,c9 as g}from"./index.e22ca15e.js";/* empty css                */import{E as f}from"./pagination.1c71de03.js";/* empty css              */import"./tag.46cc5c34.js";import"./select.96194a5d.js";import"./scrollbar.efc86474.js";/* empty css               */import{E as v,a as b}from"./table-column.a83e6cf2.js";import"./checkbox.bea932b2.js";/* empty css                */import{E as j,a as h}from"./form-item.8c20599d.js";/* empty css               */import{_ as w,U as y,g as _,d as x,e as C}from"./common.35af8f1a.js";import{C as k}from"./index.069990d9.js";import{f as U}from"./format.c2d47975.js";import{W as E}from"./warningBar.d352a93c.js";import{_ as z}from"./_plugin-vue_export-helper.cdc0426e.js";import{E as O}from"./index.e347d1a7.js";import"./isEqual.c0ca3f92.js";import"./_Uint8Array.ef0d212b.js";import"./index.21b03b03.js";import"./strings.36175d48.js";import"./_initCloneObject.671954bf.js";import"./upload.06d67d78.js";import"./progress.46d67fb7.js";import"./date.23f5a973.js";import"./dictionary.e3d9631e.js";import"./sysDictionary.2b495a7f.js";/* empty css             *//* empty css                                                                   */const B=(a,e)=>{var t=new Image;t.setAttribute("crossOrigin","anonymous"),t.onload=function(){var a=document.createElement("canvas");a.width=t.width,a.height=t.height,a.getContext("2d").drawImage(t,0,0,t.width,t.height);var l=a.toDataURL("image/png"),o=document.createElement("a"),i=new MouseEvent("click");o.download=e||"photo",o.href=l,o.dispatchEvent(i)},t.src=a},S={class:"gva-table-box"},A={class:"gva-btn-list"},T=["onClick"],V={class:"gva-pagination"},I={name:"Upload"},D=z(Object.assign(I,{setup(z){const I=a("/"),D=a(""),L=a(""),M=a(1),q=a(0),F=a(10),J=a({}),P=a([]),R=a=>{F.value=a,G()},W=a=>{M.value=a,G()},G=async()=>{const a=await _({page:M.value,pageSize:F.value,...J.value});0===a.code&&(P.value=a.data.list,q.value=a.data.total,M.value=a.data.page,F.value=a.data.pageSize)};G();return(a,_)=>{const z=m,H=j,K=u,N=h,Q=v,X=O,Y=b,Z=f,$=g;return e((t(),l("div",null,[o("div",S,[i(E,{title:"点击“文件名/备注”可以编辑文件名或者备注内容。"}),o("div",A,[i(w,{imageCommon:L.value,"onUpdate:imageCommon":_[0]||(_[0]=a=>L.value=a),class:"upload-btn",onOnSuccess:G},null,8,["imageCommon"]),i(y,{imageUrl:D.value,"onUpdate:imageUrl":_[1]||(_[1]=a=>D.value=a),"file-size":512,"max-w-h":1080,class:"upload-btn",onOnSuccess:G},null,8,["imageUrl"]),i(N,{ref:"searchForm",inline:!0,model:J.value},{default:s((()=>[i(H,{label:""},{default:s((()=>[i(z,{modelValue:J.value.keyword,"onUpdate:modelValue":_[2]||(_[2]=a=>J.value.keyword=a),class:"keyword",placeholder:"请输入文件名或备注"},null,8,["modelValue"])])),_:1}),i(H,null,{default:s((()=>[i(K,{type:"primary",icon:"search",onClick:G},{default:s((()=>[n("查询")])),_:1})])),_:1})])),_:1},8,["model"])]),i(Y,{data:P.value},{default:s((()=>[i(Q,{align:"left",label:"预览",width:"100"},{default:s((a=>[i(k,{"pic-type":"file","pic-src":a.row.url},null,8,["pic-src"])])),_:1}),i(Q,{align:"left",label:"日期",prop:"UpdatedAt",width:"180"},{default:s((a=>[o("div",null,r(p(U)(a.row.UpdatedAt)),1)])),_:1}),i(Q,{align:"left",label:"文件名/备注",prop:"name",width:"180"},{default:s((a=>[o("div",{class:"name",onClick:e=>(async a=>{c.prompt("请输入文件名或者备注","编辑",{confirmButtonText:"确定",cancelButtonText:"取消",inputPattern:/\S/,inputErrorMessage:"不能为空",inputValue:a.name}).then((async({value:e})=>{a.name=e,0===(await C(a)).code&&(d({type:"success",message:"编辑成功!"}),G())})).catch((()=>{d({type:"info",message:"取消修改"})}))})(a.row)},r(a.row.name),9,T)])),_:1}),i(Q,{align:"left",label:"链接",prop:"url","min-width":"300"}),i(Q,{align:"left",label:"标签",prop:"tag",width:"100"},{default:s((a=>[i(X,{type:"jpg"===a.row.tag?"primary":"success","disable-transitions":""},{default:s((()=>[n(r(a.row.tag),1)])),_:2},1032,["type"])])),_:1}),i(Q,{align:"left",label:"操作",width:"160"},{default:s((a=>[i(K,{icon:"download",type:"primary",link:"",onClick:e=>{var t;(t=a.row).url.indexOf("http://")>-1||t.url.indexOf("https://")>-1?B(t.url,t.name):B(I.value+"/"+t.url,t.name)}},{default:s((()=>[n("下载")])),_:2},1032,["onClick"]),i(K,{icon:"delete",type:"primary",link:"",onClick:e=>(async a=>{c.confirm("此操作将永久删除文件, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((async()=>{0===(await x(a)).code&&(d({type:"success",message:"删除成功!"}),1===P.value.length&&M.value>1&&M.value--,G())})).catch((()=>{d({type:"info",message:"已取消删除"})}))})(a.row)},{default:s((()=>[n("删除")])),_:2},1032,["onClick"])])),_:1})])),_:1},8,["data"]),o("div",V,[i(Z,{"current-page":M.value,"page-size":F.value,"page-sizes":[10,30,50,100],style:{float:"right",padding:"20px"},total:q.value,layout:"total, sizes, prev, pager, next, jumper",onCurrentChange:W,onSizeChange:R},null,8,["current-page","page-size","total"])])])])),[[$,a.fullscreenLoading,void 0,{fullscreen:!0,lock:!0}]])}}}),[["__scopeId","data-v-caa96911"]]);export{D as default};
