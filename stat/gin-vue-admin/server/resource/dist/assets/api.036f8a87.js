/*! 
 Build based on gin-vue-admin 
 Time : 1680873134000 */
import{r as e,o as a,c as l,d as t,e as o,w as u,U as i,aC as s,a0 as r,h as d,a3 as p,j as n,bm as m,b as c,E as v,bh as f,bi as b}from"./index.e22ca15e.js";import{E as g}from"./dialog.844a69bd.js";import"./overlay.b9869d98.js";import{E as h}from"./pagination.1c71de03.js";/* empty css              */import"./tag.46cc5c34.js";import{E as y,a as _}from"./select.96194a5d.js";import"./scrollbar.efc86474.js";/* empty css               */import{E as j,a as w}from"./table-column.a83e6cf2.js";import"./checkbox.bea932b2.js";/* empty css                */import{E as V}from"./popover.16ea0d1a.js";import{E as k,a as C}from"./form-item.8c20599d.js";/* empty css               */import{g as x,d as A,a as U,u as E,c as G,b as I}from"./api.ab90f01e.js";import{t as z}from"./stringFun.2b3a18f6.js";import{W as P}from"./warningBar.d352a93c.js";import{_ as S}from"./_plugin-vue_export-helper.cdc0426e.js";import"./refs.e55ffb18.js";import"./isEqual.c0ca3f92.js";import"./_Uint8Array.ef0d212b.js";import"./index.21b03b03.js";import"./index.e347d1a7.js";import"./strings.36175d48.js";import"./_initCloneObject.671954bf.js";import"./dropdown.c097faf7.js";/* empty css             *//* empty css                                                                   */const T={class:"gva-search-box"},q={class:"gva-table-box"},D={class:"gva-btn-list"},$=(e=>(f("data-v-9de54fa6"),e=e(),b(),e))((()=>t("p",null,"确定要删除吗？",-1))),B={style:{"text-align":"right","margin-top":"8px"}},F={class:"gva-pagination"},O={class:"dialog-footer"},K={name:"Api"},L=S(Object.assign(K,{setup(f){const b=e=>{const a=L.value.filter((a=>a.value===e))[0];return a&&`${a.label}`},S=e([]),K=e({path:"",apiGroup:"",method:"",description:""}),L=e([{value:"POST",label:"创建",type:"success"},{value:"GET",label:"查看",type:""},{value:"PUT",label:"更新",type:"warning"},{value:"DELETE",label:"删除",type:"danger"}]),W=e(""),H=e({path:[{required:!0,message:"请输入api路径",trigger:"blur"}],apiGroup:[{required:!0,message:"请输入组名称",trigger:"blur"}],method:[{required:!0,message:"请选择请求方式",trigger:"blur"}],description:[{required:!0,message:"请输入api介绍",trigger:"blur"}]}),J=e(1),M=e(0),N=e(10),Q=e([]),R=e({}),X=()=>{R.value={}},Y=()=>{J.value=1,N.value=10,le()},Z=e=>{N.value=e,le()},ee=e=>{J.value=e,le()},ae=({prop:e,order:a})=>{e&&("ID"===e&&(e="id"),R.value.orderKey=z(e),R.value.desc="descending"===a),le()},le=async()=>{const e=await x({page:J.value,pageSize:N.value,...R.value});0===e.code&&(Q.value=e.data.list,M.value=e.data.total,J.value=e.data.page,N.value=e.data.pageSize)};le();const te=e=>{S.value=e},oe=e(!1),ue=async()=>{const e=S.value.map((e=>e.ID)),a=await A({ids:e});0===a.code&&(n({type:"success",message:a.msg}),Q.value.length===e.length&&J.value>1&&J.value--,oe.value=!1,le())},ie=e(null),se=e("新增Api"),re=e(!1),de=e=>{switch(e){case"addApi":se.value="新增Api";break;case"edit":se.value="编辑Api"}W.value=e,re.value=!0},pe=()=>{ie.value.resetFields(),K.value={path:"",apiGroup:"",method:"",description:""},re.value=!1},ne=async()=>{ie.value.validate((async e=>{if(e)switch(W.value){case"addApi":0===(await G(K.value)).code&&n({type:"success",message:"添加成功",showClose:!0}),le(),pe();break;case"edit":0===(await E(K.value)).code&&n({type:"success",message:"编辑成功",showClose:!0}),le(),pe();break;default:n({type:"error",message:"未知操作",showClose:!0})}}))};return(e,f)=>{const x=c,A=k,E=y,G=_,z=v,W=C,me=V,ce=j,ve=w,fe=h,be=g;return a(),l("div",null,[t("div",T,[o(W,{ref:"searchForm",inline:!0,model:R.value},{default:u((()=>[o(A,{label:"路径"},{default:u((()=>[o(x,{modelValue:R.value.path,"onUpdate:modelValue":f[0]||(f[0]=e=>R.value.path=e),placeholder:"路径"},null,8,["modelValue"])])),_:1}),o(A,{label:"描述"},{default:u((()=>[o(x,{modelValue:R.value.description,"onUpdate:modelValue":f[1]||(f[1]=e=>R.value.description=e),placeholder:"描述"},null,8,["modelValue"])])),_:1}),o(A,{label:"API组"},{default:u((()=>[o(x,{modelValue:R.value.apiGroup,"onUpdate:modelValue":f[2]||(f[2]=e=>R.value.apiGroup=e),placeholder:"api组"},null,8,["modelValue"])])),_:1}),o(A,{label:"请求"},{default:u((()=>[o(G,{modelValue:R.value.method,"onUpdate:modelValue":f[3]||(f[3]=e=>R.value.method=e),clearable:"",placeholder:"请选择"},{default:u((()=>[(a(!0),l(i,null,s(L.value,(e=>(a(),r(E,{key:e.value,label:`${e.label}(${e.value})`,value:e.value},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])])),_:1}),o(A,null,{default:u((()=>[o(z,{type:"primary",icon:"search",onClick:Y},{default:u((()=>[d("查询")])),_:1}),o(z,{icon:"refresh",onClick:X},{default:u((()=>[d("重置")])),_:1})])),_:1})])),_:1},8,["model"])]),t("div",q,[t("div",D,[o(z,{type:"primary",icon:"plus",onClick:f[4]||(f[4]=e=>de("addApi"))},{default:u((()=>[d("新增")])),_:1}),o(me,{modelValue:oe.value,"onUpdate:modelValue":f[7]||(f[7]=e=>oe.value=e),placement:"top",width:"160"},{reference:u((()=>[o(z,{icon:"delete",disabled:!S.value.length,style:{"margin-left":"10px"},onClick:f[6]||(f[6]=e=>oe.value=!0)},{default:u((()=>[d("删除")])),_:1},8,["disabled"])])),default:u((()=>[$,t("div",B,[o(z,{type:"primary",link:"",onClick:f[5]||(f[5]=e=>oe.value=!1)},{default:u((()=>[d("取消")])),_:1}),o(z,{type:"primary",onClick:ue},{default:u((()=>[d("确定")])),_:1})])])),_:1},8,["modelValue"])]),o(ve,{data:Q.value,onSortChange:ae,onSelectionChange:te},{default:u((()=>[o(ce,{type:"selection",width:"55"}),o(ce,{align:"left",label:"id","min-width":"60",prop:"ID",sortable:"custom"}),o(ce,{align:"left",label:"API路径","min-width":"150",prop:"path",sortable:"custom"}),o(ce,{align:"left",label:"API分组","min-width":"150",prop:"apiGroup",sortable:"custom"}),o(ce,{align:"left",label:"API简介","min-width":"150",prop:"description",sortable:"custom"}),o(ce,{align:"left",label:"请求","min-width":"150",prop:"method",sortable:"custom"},{default:u((e=>[t("div",null,p(e.row.method)+" / "+p(b(e.row.method)),1)])),_:1}),o(ce,{align:"left",fixed:"right",label:"操作",width:"200"},{default:u((e=>[o(z,{icon:"edit",type:"primary",link:"",onClick:a=>(async e=>{const a=await U({id:e.ID});K.value=a.data.api,de("edit")})(e.row)},{default:u((()=>[d("编辑")])),_:2},1032,["onClick"]),o(z,{icon:"delete",type:"primary",link:"",onClick:a=>(async e=>{m.confirm("此操作将永久删除所有角色下该api, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((async()=>{0===(await I(e)).code&&(n({type:"success",message:"删除成功!"}),1===Q.value.length&&J.value>1&&J.value--,le())}))})(e.row)},{default:u((()=>[d("删除")])),_:2},1032,["onClick"])])),_:1})])),_:1},8,["data"]),t("div",F,[o(fe,{"current-page":J.value,"page-size":N.value,"page-sizes":[10,30,50,100],total:M.value,layout:"total, sizes, prev, pager, next, jumper",onCurrentChange:ee,onSizeChange:Z},null,8,["current-page","page-size","total"])])]),o(be,{modelValue:re.value,"onUpdate:modelValue":f[12]||(f[12]=e=>re.value=e),"before-close":pe,title:se.value},{footer:u((()=>[t("div",O,[o(z,{onClick:pe},{default:u((()=>[d("取 消")])),_:1}),o(z,{type:"primary",onClick:ne},{default:u((()=>[d("确 定")])),_:1})])])),default:u((()=>[o(P,{title:"新增API，需要在角色管理内配置权限才可使用"}),o(W,{ref_key:"apiForm",ref:ie,model:K.value,rules:H.value,"label-width":"80px"},{default:u((()=>[o(A,{label:"路径",prop:"path"},{default:u((()=>[o(x,{modelValue:K.value.path,"onUpdate:modelValue":f[8]||(f[8]=e=>K.value.path=e),autocomplete:"off"},null,8,["modelValue"])])),_:1}),o(A,{label:"请求",prop:"method"},{default:u((()=>[o(G,{modelValue:K.value.method,"onUpdate:modelValue":f[9]||(f[9]=e=>K.value.method=e),placeholder:"请选择",style:{width:"100%"}},{default:u((()=>[(a(!0),l(i,null,s(L.value,(e=>(a(),r(E,{key:e.value,label:`${e.label}(${e.value})`,value:e.value},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])])),_:1}),o(A,{label:"api分组",prop:"apiGroup"},{default:u((()=>[o(x,{modelValue:K.value.apiGroup,"onUpdate:modelValue":f[10]||(f[10]=e=>K.value.apiGroup=e),autocomplete:"off"},null,8,["modelValue"])])),_:1}),o(A,{label:"api简介",prop:"description"},{default:u((()=>[o(x,{modelValue:K.value.description,"onUpdate:modelValue":f[11]||(f[11]=e=>K.value.description=e),autocomplete:"off"},null,8,["modelValue"])])),_:1})])),_:1},8,["model","rules"])])),_:1},8,["modelValue","title"])])}}}),[["__scopeId","data-v-9de54fa6"]]);export{L as default};
